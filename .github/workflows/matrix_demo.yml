name: üß™ Matrix Filter Demo

on:
  schedule:
    - cron: '0 11 * * 1'  # Every Monday 2PM UTC
  workflow_dispatch:
    inputs:
      service:
        description: 'Service to test'
        required: false
        default: ''
      env:
        description: 'Environment to test'
        required: false
        default: ''

jobs:
  simulate:
    runs-on: ubuntu-latest

    strategy:
      matrix:
        include:
          - service: sample
            env: stg
          - service: sample
            env: uat
          - service: user
            env: stg
          - service: user
            env: uat

    steps:
      - name: ‚õî Skip if inputs do not match matrix
        if: ${{ github.event_name == 'workflow_dispatch' && (
                  (github.event.inputs.service != '' && github.event.inputs.service != matrix.service) ||
                  (github.event.inputs.env != '' && github.event.inputs.env != matrix.env)
              ) }}
        run: |
          echo "‚ùå Skipping: matrix does not match workflow_dispatch inputs"
          exit 0

      - name: üì¢ Print Info
        run: |
          echo "Triggered by: ${{ github.event_name }}"
          echo "Input service: ${{ github.event.inputs.service }}"
          echo "Input env:     ${{ github.event.inputs.env }}"
          echo "Matrix service: ${{ matrix.service }}"
          echo "Matrix env:     ${{ matrix.env }}"
          echo "‚úÖ This job ran because inputs matched matrix or it was scheduled!"
